---
title: System Overview
date: 2025-4-16 11:38:09
permalink: /pages/system/
---
## Module Introduction

The System module provides comprehensive system-level operations for Android STB platforms. It encompasses application management, LED control, system properties access, device operations, and version management. This module is designed to fulfill developers' needs for deep system integration and control.

### Key Features

- **Application Management**: Launch apps, clear data, and manage third-party applications
- **LED Control**: Manage various LED indicators (power, remote, network status)
- **System Properties**: Access and modify system properties, including MAC addresses and version info
- **Device Operations**: System reboot, sleep/wake, factory reset, timezone management
- **OTA Management**: Handle OTA update URLs and launch update processes
- **Version Information**: Retrieve library version information

> Import the package `import com.giec.stb.core.system.*`

## AppUtil

The `AppUtil` object provides comprehensive application management capabilities.

### API Reference

| Method | Description | Parameters | Return Type |
|--------|-------------|------------|-------------|
| `launchApp(context, packageName)` | Launches app by package name | `context: Context, packageName: String` | `Unit` |
| `launchApp(context, packageName, activityName)` | Launches specific activity | `context: Context, packageName: String, activityName: String` | `Unit` |
| `launchBtSetupActivity(context)` | Launches Bluetooth setup activity | `context: Context` | `Unit` |
| `launchOtaUpdate(context)` | Launches OTA update application | `context: Context` | `Unit` |
| `clearAppData(context, packageName)` | Clears single app data | `context: Context, packageName: String` | `Boolean` |
| `clearAllAppData(context)` | Clears all third-party app data | `context: Context` | `Map<String, Boolean>` |
| `deleteAccountsByPackageName(context, packageName)` | Deletes accounts by package | `context: Context, packageName: String` | `Unit` |

### Usage Examples

```kotlin
import com.giec.stb.core.system.AppUtil

// Launch app by package name (using launcher intent)
AppUtil.launchApp(context, "com.example.myapp")

// Launch specific activity within an app
AppUtil.launchApp(context, "com.example.myapp", "com.example.myapp.MainActivity")

// Launch Bluetooth setup activity
AppUtil.launchBtSetupActivity(context)

// Launch OTA update application
AppUtil.launchOtaUpdate(context)

// Clear data for a specific app
val success = AppUtil.clearAppData(context, "com.example.myapp")
if (success) {
    println("App data cleared successfully")
}

// Clear data for all third-party apps
val results = AppUtil.clearAllAppData(context)
results.forEach { (packageName, success) ->
    println("$packageName: ${if (success) "Success" else "Failed"}")
}

// Delete accounts associated with a package
AppUtil.deleteAccountsByPackageName(context, "com.example.myapp")
```

### Implementation Details

- Uses `PackageManager` for app launching and discovery
- Automatically filters system apps (including GIEC apps) from bulk operations
- Handles account cleanup before clearing app data
- Provides comprehensive error handling and logging
- Supports both launcher intents and explicit activity launching

---

## LedUtil

The `LedUtil` object provides control over various LED indicators on the device.

::: warning Hardware Dependency
LED functionality depends on hardware availability. On certain motherboards, LED operations may not function if the hardware is not present.
:::

### API Reference

| Method | Description | Return Type |
|--------|-------------|-------------|
| `openPowerLed()` | Turns on the power LED | `Boolean` |
| `closePowerLed()` | Turns off the power LED | `Boolean` |
| `openRemoteLed()` | Turns on the remote signal LED | `Boolean` |
| `closeRemoteLed()` | Turns off the remote signal LED | `Boolean` |
| `openNetGreenLed()` | Turns on the green network LED | `Boolean` |
| `closeNetGreenLed()` | Turns off the green network LED | `Boolean` |
| `openNetRedLed()` | Turns on the red network LED | `Boolean` |
| `closeNetRedLed()` | Turns off the red network LED | `Boolean` |
| `switchLed(led, enable)` | Generic LED control method | `Boolean` |

### Usage Examples

```kotlin
import com.giec.stb.core.system.LedUtil

// Power LED control
val powerLedOn = LedUtil.openPowerLed()
val powerLedOff = LedUtil.closePowerLed()

// Remote signal LED control
val remoteLedOn = LedUtil.openRemoteLed()
val remoteLedOff = LedUtil.closeRemoteLed()

// Network status LEDs
val greenLedOn = LedUtil.openNetGreenLed()
val greenLedOff = LedUtil.closeNetGreenLed()
val redLedOn = LedUtil.openNetRedLed()
val redLedOff = LedUtil.closeNetRedLed()

// Generic LED control (advanced usage)
val success = LedUtil.switchLed("custom_led", true)
if (!success) {
    println("LED hardware not available or operation failed")
}
```

### Implementation Details

- Uses `/sys/class/leds` interface for LED control
- Checks hardware availability before operations
- Returns `Boolean` to indicate operation success/failure
- Supports custom LED names through `switchLed()` method
- All operations are logged for debugging purposes

---

## SystemOperation

The `SystemOperation` object provides system-level device operations.

### API Reference

| Method | Description | Parameters | Return Type |
|--------|-------------|------------|-------------|
| `setTimeZone(context, timeZoneId)` | Sets device timezone | `context: Context, timeZoneId: String` | `Unit` |
| `openDateAndTimeSettings(context)` | Opens date/time settings | `context: Context` | `Unit` |
| `reboot(context)` | Reboots the device | `context: Context` | `Unit` |
| `putDeviceToSleep(context)` | Puts device to sleep | `context: Context` | `Unit` |
| `putDeviceToWakeUp(context)` | Wakes up the device | `context: Context` | `Unit` |
| `factoryReset(context)` | Performs factory reset | `context: Context` | `Unit` |
| `launchOtaUpdate(context)` | Launches OTA update | `context: Context` | `Unit` |
| `setDisplayMode(context, width, height, refreshRate)` | Sets the display mode | `context: Context`, `width: Int`, `height: Int`, `refreshRate: Float` | `Boolean` |

### Usage Examples

```kotlin
import com.giec.stb.core.system.SystemOperation

// Set device timezone
SystemOperation.setTimeZone(context, "America/New_York")

// Open system date and time settings
SystemOperation.openDateAndTimeSettings(context)

// Reboot the device
SystemOperation.reboot(context)

// Put device to sleep
SystemOperation.putDeviceToSleep(context)

// Wake up the device
SystemOperation.putDeviceToWakeUp(context)

// Perform factory reset (use with caution!)
SystemOperation.factoryReset(context)

// Launch OTA update application
SystemOperation.launchOtaUpdate(context)

// Sets the display mode including resolution and refresh rate.
SystemOperation.setDisplayMode(context, 1920, 1080, 60.0f)
```

### Implementation Details

- Requires system-level permissions for most operations
- Includes comprehensive error handling
- Operations are logged for debugging and monitoring

---

## SystemProperties

The `SystemProperties` object provides access to Android system properties.

### API Reference

| Method | Description | Parameters | Return Type |
|--------|-------------|------------|-------------|
| `getSystemProperty(node)` | Gets any system property | `node: String` | `String` |
| `setSystemProperty(node, value)` | Sets system property | `node: String, value: String` | `String` |
| `getSystemVersion()` | Gets system version | None | `String` |
| `getSN()` | Gets device serial number | None | `String` |
| `getMAC()` | Gets LAN MAC address | None | `String` |
| `getWifiMAC()` | Gets WiFi MAC address | None | `String` |
| `getInOtaUrl()` | Gets internal OTA URL | None | `String` |
| `getExtOtaUrl()` | Gets external OTA URL | None | `String` |
| `setInOtaUrl(value)` | Sets internal OTA URL | `value: String` | `String` |
| `setExtOtaUrl(value)` | Sets external OTA URL | `value: String` | `String` |

### Predefined Property Nodes

| Constant | Property Node | Description |
|----------|---------------|-------------|
| `SYSTEM_VERSION_NODE` | `ro.build.display.id` | System version |
| `LAN_MAC_NODE` | `ro.boot.mac` | LAN MAC address |
| `SN_NODE` | `ro.serialno` | Serial number |
| `OTA_URL_IN` | `persist.sys.otaurl.int` | Internal OTA URL |
| `OTA_URL_EXT` | `persist.sys.otaurl.ext` | External OTA URL |

### Usage Examples

```kotlin
import com.giec.stb.core.system.SystemProperties

// Get system properties
val systemVersion = SystemProperties.getSystemVersion()
val serialNumber = SystemProperties.getSN()
val lanMac = SystemProperties.getMAC()  // Returns uppercase, no colons
val wifiMac = SystemProperties.getWifiMAC()  // Returns uppercase, no colons

// Get custom system property
val customProp = SystemProperties.getSystemProperty("ro.build.fingerprint")

// Set custom system property
val result = SystemProperties.setSystemProperty("persist.sys.custom", "value")

// OTA URL management
val internalOtaUrl = SystemProperties.getInOtaUrl()
val externalOtaUrl = SystemProperties.getExtOtaUrl()

SystemProperties.setInOtaUrl("http://internal.ota.server/")
SystemProperties.setExtOtaUrl("http://external.ota.server/")

println("System Version: $systemVersion")
println("Serial Number: $serialNumber")
println("LAN MAC: $lanMac")
println("WiFi MAC: $wifiMac")
```

### Implementation Details

- MAC addresses are automatically formatted (uppercase, no colons)
- All return values are String type
- Property nodes can be viewed using `adb shell getprop`

---

## VersionUtil

The `VersionUtil` object provides library version information.

### API Reference

| Method | Description | Return Type |
|--------|-------------|-------------|
| `getLibraryVersion()` | Gets current library version | `String` |

### Usage Examples

```kotlin
import com.giec.stb.core.system.VersionUtil

// Get current library version
val version = VersionUtil.getLibraryVersion()
println("GIEC-core Library Version: $version")

// Use in about dialog or version display
fun showAbout() {
    val libraryVersion = VersionUtil.getLibraryVersion()
    val message = "App powered by GIEC-core v$libraryVersion"
    // Display message to user
}
```

### Implementation Details

- Version is retrieved from `BuildConfig.LIBRARY_VERSION`
- Version is set during build process from `build.gradle.kts`
- Returns current library version as defined in build configuration

## Best Practices

1. **System Permissions**: Most system operations require system-level permissions (`android:sharedUserId="android.uid.system"`)
2. **Error Handling**: Always check return values for Boolean methods
3. **Hardware Verification**: Check LED operation results before assuming success
4. **Caution with Destructive Operations**: Use factory reset and reboot operations carefully
5. **Property Access**: Use predefined constants for common system properties
6. **Logging**: Utilize built-in logging to track system operations